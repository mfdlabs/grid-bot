<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <TargetFramework>net472</TargetFramework>
        <GenerateAssemblyInfo>False</GenerateAssemblyInfo>
        <Deterministic>False</Deterministic>
        <AutoGenerateBindingRedirects>True</AutoGenerateBindingRedirects>
        <LangVersion>9</LangVersion>
        <AssemblyName>MFDLabs.Grid.Bot</AssemblyName>
        <RootNamespace>MFDLabs.Grid.Bot</RootNamespace>
		<Configurations>Debug;Release;ReleaseGridDeploy;DebugGridDeploy;ReleaseNoDeploy;DebugDeploy</Configurations>
    </PropertyGroup>

    <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|AnyCPU'">
        <WarningLevel>0</WarningLevel>
        <DebugType>none</DebugType>
        <DebugSymbols>false</DebugSymbols>
    </PropertyGroup>
	
	<PropertyGroup Condition=" '$(Configuration)' == 'ReleaseNoDeploy' ">
      <OutputPath>bin\Release\</OutputPath>
      <Optimize>true</Optimize>
      <DebugType>none</DebugType>
      <WarningLevel>0</WarningLevel>
    </PropertyGroup>
	
	<PropertyGroup Condition=" '$(Configuration)' == 'ReleaseGridDeploy' ">
      <OutputPath>bin\Release\</OutputPath>
      <DefineConstants>TRACE;WE_ON_THE_GRID</DefineConstants>
      <Optimize>true</Optimize>
      <DebugType>none</DebugType>
      <WarningLevel>0</WarningLevel>
    </PropertyGroup>
	
	<PropertyGroup Condition=" '$(Configuration)' == 'DebugDeploy' ">
      <OutputPath>bin\Debug\</OutputPath>
      <DefineConstants>TRACE;DEBUG</DefineConstants>
      <DebugSymbols>true</DebugSymbols>
    </PropertyGroup>

    <PropertyGroup Condition=" '$(Configuration)' == 'DebugGridDeploy' ">
      <OutputPath>bin\Debug\</OutputPath>
      <DefineConstants>TRACE;DEBUG;WE_ON_THE_GRID</DefineConstants>
      <DebugSymbols>true</DebugSymbols>
    </PropertyGroup>
	
	<ItemGroup Condition=" '$(TargetFrameworkIdentifier)' == '.NETFramework' ">
        <Reference Include="System.Configuration" />
    </ItemGroup>

    <ItemGroup Condition=" '$(TargetFrameworkIdentifier)' != '.NETFramework' ">
        <PackageReference Include="System.Configuration.ConfigurationManager" Version="5.0.0" />
    </ItemGroup>

    <ItemGroup>
      <PackageReference Include="Microsoft.Bcl.AsyncInterfaces" Version="5.0.0" />
      <PackageReference Include="Microsoft.Extensions.DependencyInjection.Abstractions" Version="5.0.0" />
      <PackageReference Include="System.Linq.Async" Version="5.0.0" />
      <PackageReference Include="System.Text.Encoding.CodePages" Version="5.0.0" />
    </ItemGroup>

    <ItemGroup>
      <ProjectReference Include="..\Assemblies\MFDLabs.Analytics.Google\MFDLabs.Analytics.Google.csproj" />
      <ProjectReference Include="..\Assemblies\MFDLabs.Backtrace\MFDLabs.Backtrace.csproj" />
      <ProjectReference Include="..\Shared\MFDLabs.GridCommands\MFDLabs.GridCommands.csproj" />
      <ProjectReference Include="..\Shared\MFDLabs.GridDiagnostics\MFDLabs.GridDiagnostics.csproj" />
      <ProjectReference Include="..\Shared\MFDLabs.GridEvents\MFDLabs.GridEvents.csproj" />
      <ProjectReference Include="..\Shared\MFDLabs.GridGlobal\MFDLabs.GridGlobal.csproj" />
      <ProjectReference Include="..\Shared\MFDLabs.GridHooks\MFDLabs.GridHooks.csproj" />
      <ProjectReference Include="..\Shared\MFDLabs.GridSettings\MFDLabs.GridSettings.csproj" />
      <ProjectReference Include="..\Shared\MFDLabs.GridUtility\MFDLabs.GridUtility.csproj" />
    </ItemGroup>

    <Target Name="PostBuild" AfterTargets="PostBuildEvent">
      <Exec Command="SET AppSettingsConfiguration=$(ConfigurationName)&#xD;&#xA;SET IsDebug=F&#xD;&#xA;&#xD;&#xA;rem Determine the current configuration&#xD;&#xA;IF &quot;%25AppSettingsConfiguration%25&quot;==&quot;DebugGridDeploy&quot; (&#xD;&#xA;    SET IsDebug=T&#xD;&#xA;    SET AppSettingsConfiguration=Debug-Vault&#xD;&#xA;)&#xD;&#xA;IF &quot;%25AppSettingsConfiguration%25&quot;==&quot;DebugRunner&quot; (&#xD;&#xA;    SET IsDebug=T&#xD;&#xA;    SET AppSettingsConfiguration=Debug-OnTheRun&#xD;&#xA;)&#xD;&#xA;IF &quot;%25AppSettingsConfiguration%25&quot;==&quot;DebugActor&quot; (&#xD;&#xA;    SET IsDebug=T&#xD;&#xA;    SET AppSettingsConfiguration=Debug-Root&#xD;&#xA;)&#xD;&#xA;IF &quot;%25AppSettingsConfiguration%25&quot;==&quot;ReleaseGridDeploy&quot; SET AppSettingsConfiguration=Release-Vault&#xD;&#xA;IF &quot;%25AppSettingsConfiguration%25&quot;==&quot;ReleaseRunner&quot; SET AppSettingsConfiguration=Release-OnTheRun&#xD;&#xA;IF &quot;%25AppSettingsConfiguration%25&quot;==&quot;ReleaseActor&quot; SET AppSettingsConfiguration=Release-Root&#xD;&#xA;&#xD;&#xA;rem Deploying locally with no actor or runner&#xD;&#xA;IF &quot;%25AppSettingsConfiguration%25&quot;==&quot;DebugDeploy&quot; (&#xD;&#xA;    SET AppSettingsConfiguration=Debug&#xD;&#xA;    SET IsDebug=T&#xD;&#xA;)&#xD;&#xA;)&#xD;&#xA;IF &quot;%25AppSettingsConfiguration%25&quot;==&quot;ReleaseNoDeploy&quot; SET AppSettingsConfiguration=Release&#xD;&#xA;&#xD;&#xA;rem Copy the current configuration settings to the target&#xD;&#xA;COPY /Y &quot;$(ProjectDir)App.%25AppSettingsConfiguration%25.config&quot; &quot;$(ProjectDir)$(OutDir)$(TargetName)$(TargetExt).config&quot;&#xD;&#xA;&#xD;&#xA;rem Delete the old runtime-scripts, in case there are any old files that are not in the new runtime-scripts&#xD;&#xA;IF EXIST $(ProjectDir)$(OutDir)RuntimeScripts\ RMDIR $(ProjectDir)$(OutDir)RuntimeScripts\ /S/Q&#xD;&#xA;&#xD;&#xA;rem Copy the new runtime-scripts&#xD;&#xA;XCOPY $(ProjectDir)RuntimeScripts\ $(ProjectDir)$(OutDir)RuntimeScripts\ /E/H/C/I/F/Y&#xD;&#xA;&#xD;&#xA;rem Delete the old lua scripts, in case there are any old files that are not in the new lua scripts&#xD;&#xA;IF EXIST $(ProjectDir)$(OutDir)Lua\ RMDIR $(ProjectDir)$(OutDir)Lua\ /S/Q&#xD;&#xA;&#xD;&#xA;rem Copy the new lua scripts&#xD;&#xA;XCOPY $(ProjectDir)Lua\ $(ProjectDir)$(OutDir)Lua\ /E/H/C/I/F/Y&#xD;&#xA;&#xD;&#xA;rem Determine if we are deploying a component build&#xD;&#xA;SET IsDeployment=F&#xD;&#xA;IF &quot;$(Configuration)&quot;==&quot;DebugDeploy&quot; SET IsDeployment=T&#xD;&#xA;IF &quot;$(Configuration)&quot;==&quot;Release&quot; SET IsDeployment=T&#xD;&#xA;IF &quot;$(Configuration)&quot;==&quot;ReleaseGridDeploy&quot; SET IsDeployment=T&#xD;&#xA;IF &quot;$(Configuration)&quot;==&quot;ReleaseRunner&quot; SET IsDeployment=T&#xD;&#xA;IF &quot;$(Configuration)&quot;==&quot;ReleaseActor&quot; SET IsDeployment=T&#xD;&#xA;&#xD;&#xA;SET DeploymentConfiguration=Release&#xD;&#xA;IF &quot;%25IsDebug%25&quot;==&quot;T&quot; SET DeploymentConfiguration=Debug&#xD;&#xA;&#xD;&#xA;ECHO $(TargetFramework)&#xD;&#xA;&#xD;&#xA;IF &quot;%25IsDeployment%25&quot;==&quot;T&quot; (&#xD;&#xA;	ECHO Deploying with configuration &quot;%25AppSettingsConfiguration%25&quot;&#xD;&#xA;&#xD;&#xA;    rem Determine if we are deploying a debug or release build, if release delete all pdb files&#xD;&#xA;    IF NOT &quot;%25IsDebug%25&quot; == &quot;T&quot; del /q &quot;$(TargetDir)*.pdb&quot;&#xD;&#xA;&#xD;&#xA;    rem Call on the deploy script&#xD;&#xA;    ECHO &quot;Deploying.&quot;&#xD;&#xA;    powershell -ExecutionPolicy Unrestricted &quot;$(SolutionDir)Deploy.ps1&quot; -root $(SolutionDir) -config %25DeploymentConfiguration%25 -targetFramework $(TargetFramework)&#xD;&#xA;)&#xD;&#xA;" />
    </Target>

</Project>
